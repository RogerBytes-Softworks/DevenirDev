<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>12 Les évènements</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/github-markdown.css" />
    <script src="assets/js/jquery-3.4.1.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="assets/css/stackoverflow-dark.min.css" />
    <script src="assets/js/highlight.min.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="markdown-body">
        <h1 id="1">12 Les évènements</h1>
        <h2 id="2">Définition</h2>
        <p>
          Les évènements correspondent à des actions effectuées soit par un
          utilisateur, soit par le navigateur lui-même.
        </p>
        <p>
          Ce sont les évènements qui permettent la grande interactivité du
          Javascript.
        </p>
        <p>
          Vous connaissez déjà des évènements sans les connaître : cliquer sur
          un lien est un évènement, charger une page web l’est aussi ou encore
          envoyer un formulaire en cliquant sur le bouton de type
          <code>submit</code>.
        </p>
        <h2 id="6">Liste des événements</h2>
        <p>
          Il existe des évènements dits <strong>standard</strong>, c’est-à-dire
          validés par la norme ECMA, et des évènements dits non standards non
          reconnus par la norme ECMA, ces évènements sont spécifiques aux
          naviga-teurs.
        </p>
        <p>Voici la liste des principaux évènements Javascript :</p>
        <table>
          <thead>
            <tr>
              <th>Evènement</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>blur</td>
              <td>Lorsqu’un élément de formulaire perd le focus</td>
            </tr>
            <tr>
              <td>change</td>
              <td>Lorsque la valeur d'un champ de formulaire est modifiée</td>
            </tr>
            <tr>
              <td>click</td>
              <td>
                Lorsque l'utilisateur clique sur un bouton, un lien ou tout
                autre élément
              </td>
            </tr>
            <tr>
              <td>focus</td>
              <td>Lorsqu’un élément de formulaire prend le focus</td>
            </tr>
            <tr>
              <td>load</td>
              <td>Lorsque la page est chargée par le navigateur</td>
            </tr>
            <tr>
              <td>mouseover</td>
              <td>
                Lorsque l'utilisateur place le pointeur de la souris sur un lien
                ou tout autre élément
              </td>
            </tr>
            <tr>
              <td>mouseout</td>
              <td>
                Lorsque le pointeur de la souris quitte un lien ou tout autre
                élément
              </td>
            </tr>
            <tr>
              <td>select</td>
              <td>
                Lorsque l'utilisateur sélectionne un champ dans un élément de
                formulaire
              </td>
            </tr>
            <tr>
              <td>submit</td>
              <td>
                Lorsque l'utilisateur clique sur le bouton de soumission d’un
                formulaire
              </td>
            </tr>
            <tr>
              <td>unload</td>
              <td>Lorsque l'utilisateur quitte la page</td>
            </tr>
          </tbody>
        </table>
        <p>
          <em
            ><a href="https://www.w3schools.com/jsref/dom_obj_event.asp"
              >Liste complète des évènements</a
            ></em
          >
        </p>
        <blockquote>
          <p>
            <strong
              >N’appelez jamais la fonction
              <em><code>document.write()</code></em
              >; depuis un évènement car cela remplacerait tout le contenu de la
              page !</strong
            >
          </p>
        </blockquote>
        <h2 id="12">Les événements en pratique</h2>
        <p>
          Lorsqu’un évènement a lieu, Javascript va le capter et exécuter du
          code (situé généralement dans une fonction) pour exécuter des actions
          consécutives à l’évènement (par exemple modifier une couleur ou une
          dimension, contrôler la saisie dans un champ de formulaire, mettre à
          jour du contenu HTML ou des données).
        </p>
        <h3 id="14">Gestionnaire d’évènement</h3>
        <p>
          Les évènements Javascript sont interceptés via un gestionnaire
          d’évènement.
        </p>
        <p>
          Le nom de l’évènement doit être écrit en
          <strong>CamelCase</strong> préfixé par « <strong>on</strong> », par
          exemple :
        </p>
        <table>
          <thead>
            <tr>
              <th>Evènement</th>
              <th>Attribut HTML</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>click</td>
              <td>onClick</td>
            </tr>
            <tr>
              <td>mouseover</td>
              <td>onMouseOver</td>
            </tr>
          </tbody>
        </table>
        <blockquote>
          <p><code>onEvenement="fonction()";</code></p>
        </blockquote>
        <p>Par exemple,</p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">"alert('OK')"</span>&gt;</span>Clique ici<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></code></pre>
        <p>
          Dans cet exemple, au clic de la souris, une boîte d'alerte avec le
          message indiqué s’ouvre.
        </p>
        <h3 id="22">Javascript « non intrusif »</h3>
        <p>
          Vous lirez souvent sur le web des exemples Javascript similaires à
          celui du paragraphe précédent où le code de l’évènement se situe
          directement dans la balise HTML (<code>onClick, onBlur</code> etc.).
        </p>
        <p>
          <font color="red"><strong></strong></font>
        </p>
        <h3 id="25">
          <font color="red"
            ><strong>CETTE PRATIQUE EST A OUBLIER COMPLETEMENT</strong></font
          >
        </h3>
        <p></p>
        <p>
          Depuis la sortie du HTML 5 (mais aussi déjà avant, en HTML 4), la
          bonne pratique est de séparer (voire d’externaliser complètement dans
          un fichier) le Javascript.
        </p>
        <p>On appelle ça le javascript « <strong>non intrusif</strong> ».</p>
        <p>
          Outre une meilleure visibilité du code de la page web (le javascript
          étant alors centralisé à un seul endroit), cela permet de diminuer le
          temps de chargement de la page.
        </p>
        <p>
          Par conséquent, il est nécessaire d’utiliser les évènements d’une
          autre manière, en les associant à des écouteurs d’évènements via les
          méthodes <code>addEventListener/getElementById</code> ou encore
          <code>QuerySelector</code>.
        </p>
        <h3 id="31">
          Méthodes <code>addEventListener</code> et <code>getElementById</code>
        </h3>
        <p>
          En <strong>Javascript non intrusif</strong>, on peut intercepter un
          évènement grâce aux 2 méthodes <code>getElementById</code> qui va
          cibler l’identifiant de la balise HTML et
          <code>AddEventListener</code> qui va créer un « gestionnaire d’écoute
          » sur l’objet ciblé, c’est-à-dire connecter cet objet à l’évènement
          concerné.
        </p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"fr"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button1"</span>&gt;</span>Clique-moi<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
<span class="hljs-keyword">var</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"button1"</span>);

element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
{
   <span class="hljs-title function_">alert</span>(<span class="hljs-string">"OK"</span>);
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
        <p>
          Notez que dans ce cas le nom de l’évènement n’est pas préfixé par «
          <code>on</code>».
        </p>
        <h3 id="35">Exercice</h3>
        <p>Testez l'exemple ci-dessus.</p>
        <h3 id="37">Méthodes <code>querySelector</code></h3>
        <p>
          La méthode <code>querySelector</code> présente une autre syntaxe mais
          effectue la même chose que le couple
          <code>getElementById/AddEventListener</code> :
        </p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"fr"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button1"</span>&gt;</span>Clique-moi<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#button1'</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
{
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">'Vous avez cliqué !'</span>);
}   
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
        <h3 id="40">Autres méthodes</h3>
        <p>D’autres méthodes permettent de récupérer des éléments :</p>
        <ul>
          <li>
            <code>getElementsByClassName(nom_classe)</code> : cible les éléments
            sur lesquels une (ou plusieurs) classe CSS spécifique est appliquée
            et retourne un tableau de ces éléments.
          </li>
        </ul>
        <p>
          -&gt;
          <a
            href="https://developer.mozilla.org/fr/docs/Web/API/Element/getElementsByClassName"
            >documentation</a
          >
        </p>
        <ul>
          <li>
            <code>getElementsByTagName(nom_balise)</code> : cible la balise HTML
            (tag) passée en argument (une seule possible)
          </li>
        </ul>
        <p>
          -&gt;
          <a
            href="https://developer.mozilla.org/fr/docs/Web/API/Element/getElementsByTagName"
            >documentation</a
          >
        </p>
        <p>
          Attention : ne pas oublier le ‘<strong>s</strong>’ dans ces
          <strong>2 méthodes</strong> : <code>getElement</code
          ><strong><code>s</code></strong
          ><code>By</code>…
        </p>
        <h3 id="47">Gestionnaires d'événements disponibles en Javascript</h3>
        <p>
          Il nous semble utile dans cette partie "avancée" de présenter la liste
          des objets auxquels correspondent des gestionnaires d'événement bien
          déterminés.
        </p>
        <!-- TODO peut on inclure les balises <> dans les cellules ??-->
        <table>
          <thead>
            <tr>
              <th>Objets</th>
              <th>Balises</th>
              <th>Evenements</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Fenetre</td>
              <td>body</td>
              <td>load, unload, focus, blur, error</td>
            </tr>
            <tr>
              <td>Ancre</td>
              <td>a</td>
              <td>click,mouseover, mouseout</td>
            </tr>
            <tr>
              <td>Formulaire</td>
              <td>form</td>
              <td>reset, submit</td>
            </tr>
            <tr>
              <td>Eléments de formulaire</td>
              <td>
                input<br />
                select<br />textarea
              </td>
              <td>click, focus, blur, change, select (select et textarea)</td>
            </tr>
            <tr>
              <td>Elément de zone de texte</td>
              <td>
                area<br />
                map
              </td>
              <td>click, focus, blur</td>
            </tr>
            <tr>
              <td>Image</td>
              <td>img</td>
              <td>load , abort, error</td>
            </tr>
          </tbody>
        </table>
        <p>
          Il y a beaucoup d’autres gestionnaires d’événement non traités dans ce
          cours ; par exemple les événements liés au clavier :
          <strong>keypress, keydown, keyup</strong>.
        </p>
        <h3 id="51">La syntaxe de MouseOver</h3>
        <p>
          Le code du gestionnaire d'événement <code>mouseover</code> s'ajoute
          aux balises de lien :
        </p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">onMouseOver</span>=<span class="hljs-string">"action();"</span>&gt;</span>lien<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
        <p>
          Ainsi, lorsque l'utilisateur passe avec sa souris sur le lien, la
          fonction <code>action()</code>est appelée.
        </p>
        <p>
          <strong>L'attribut <code>href</code> est indispensable.</strong>
        </p>
        <p>
          Il peut contenir l'adresse d'une page Web si vous souhaitez que le
          lien soit actif ou simplement des guillemets si aucun lien actif n'est
          prévu.
        </p>
        <p>Voici un exemple.</p>
        <p>
          Par le survol du lien "message important", une fenêtre d'alerte
          s'ouvre.
        </p>
        <p>Le code est :</p>
        <pre><code class="language-html hljs language-xml">
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">onMouseOver</span>=<span class="hljs-string">"message();"</span>&gt;</span>message important<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
   <span class="hljs-keyword">function</span> <span class="hljs-title function_">message</span>(<span class="hljs-params"></span>)
   {
      <span class="hljs-title function_">alert</span>(<span class="hljs-string">"Coucou"</span>);
   }
   </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
        <h3 id="61">Changement d'images</h3>
        <p>
          Avec le gestionnaire d'événement
          <strong><code>mouseover</code></strong
          >, on peut prévoir qu'après le survol d'une image, une autre image
          apparaisse (pour autant qu'elle soit de la même taille).
        </p>
        <p>Le code est relativement simple.</p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"images/bleu_p.jpg"</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"38"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"20"</span> 
<span class="hljs-attr">onMouseOver</span>=<span class="hljs-string">"this.src='images/bleu_a.jpg'"</span>  
<span class="hljs-attr">onMouseOut</span>=<span class="hljs-string">"this.src='images/bleu_p.jpg'"</span>&gt;</span></code></pre>
        <h3 id="65">L'image invisible</h3>
        <p>
          Ce changement d'image ne vous donne-t-il pas des idées ?... Petit futé
          !
        </p>
        <p>
          Et oui, on peut prévoir une image invisible de la même couleur que
          l'arrière-plan (même transparente).
        </p>
        <p>
          On la place avec malice sur le chemin de la souris de l'utilisateur et
          son survol peut déclencher, à l'insu de l'utilisateur, un feu
          d'artifice d'actions de votre choix.
        </p>
        <h3 id="69">Exercices</h3>
        <p>
          Le clic sur le bouton <strong>Contrôler</strong> engendre l’appel à la
          fenêtre d’information.
        </p>
        <p><strong>Résultat à obtenir</strong> :</p>
        <p>
          <img
            src="assets/img/js_15_img_1.png"
            alt='image input type text + bouton "Contrôler'
          />
        </p>
        <p>
          <img
            src="assets/img/js_15_img_2.png"
            alt="Alert"
          />
        </p>
        <p>Nombre Magique (the Magic Number)</p>
        <p>Reprenez l'exercice du nombre magique</p>
        <p>
          <img
            src="assets/img/js_15_img_3.png"
            alt="Alert"
          />
        </p>
        <pre><code class="language-html hljs language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"fr"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Nombre magique<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"label1"</span>&gt;</span>Entrez votre proposition<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"textBox1"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button1"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Verifier"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"verif();"</span>&gt;</span> 

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
        <p>
          Votre programme doit générer un nombre aléatoire à l'aide de la
          fonction <code>Math.random</code>.
        </p>
        <p>
          Ecrivez la <code>fonction verif()</code> qui doit vérifier si la
          saisie de l'utilisateur (dans <code>textBox1</code>) correspond au
          nombre magique, elle affiche des informations,
          <strong>trop grand</strong>, <strong>trop petit</strong> dans le
          <code>label1</code>.
        </p>
        <p>
          Quand votre programme fonctionne, modifiez-le pour rendre le
          <strong>javascript non intrusif</strong>.
        </p>
      </div>
    </div>
    <script>
      hljs.highlightAll();
    </script>
    <script>
      document.title = "" + document.querySelector("h1").textContent;
    </script>
  </body>
</html>
