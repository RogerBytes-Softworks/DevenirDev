<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>13 Les expressions régulières</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/github-markdown.css" />
    <script src="assets/js/jquery-3.4.1.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="assets/css/stackoverflow-dark.min.css" />
    <script src="assets/js/highlight.min.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="markdown-body">
        <h1 id="1">13 Les expressions régulières</h1>
        <h2 id="2">Définition</h2>
        <p>
          Une expression régulière (du mot « règle ») ou encore expression
          rationnelle est une suite de caractère qui va permettre, de travailler
          sur des chaînes de caractères pour :
        </p>
        <ul>
          <li>
            <p>
              vérifier la validité d’une chaîne (nombre et/ou présence de
              caractères, longueur)
            </p>
          </li>
          <li>
            <p>
              effectuer des recherches dans une chaîne (par exemple trouver une
              mot ou une portion de mot)
            </p>
          </li>
          <li>
            <p>
              effectuer des remplacements de caractères ou de mots dans une
              chaîne
            </p>
          </li>
        </ul>
        <p>
          Une <strong>expression régulière</strong> agit comme un
          <strong>filtre de vérification</strong> ou une
          <strong>contrainte</strong> que l’on applique à une chaîne de
          caractères.
        </p>
        <p>
          Les expressions régulières existent dans différents langages
          (Javascript, PHP, C#…) :
        </p>
        <p>
          les filtres (écriture des expressions)
          <strong>restent les mêmes d’un langage à l’autre</strong>, par contre
          les fonctions d’exécution de ces filtres seront propres à chaque
          langage.
        </p>
        <p>
          Les expressions régulières sont plutôt efficaces en termes de contrôle
          des données, la difficulté réside dans l’écriture des règles qui peut
          paraître complexes pour les débutants.
        </p>
        <h3 id="9">Exemple</h3>
        <p>
          L’expression régulière suivante, très simple, va contrôler que le mot
          « javascript », une chaîne de caractères donc, comporte bien
          uniquement des lettres et uniquement en minuscules :
        </p>
        <pre><code class="language-js hljs language-javascript"><span class="hljs-keyword">var</span> filtre = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">"^[a-z]+$"</span>);
<span class="hljs-keyword">var</span> resultat = filtre.<span class="hljs-title function_">test</span>(<span class="hljs-string">"javascript"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(resultat);</code></pre>
        <ul>
          <li>
            Ligne 1 : on crée un filtre, qui est en fait un objet expression
            régulière RegExp de Javascript.
          </li>
        </ul>
        <p>
          Cet objet prend en argument la règle d’écriture <code>^[a-z]+$</code>.
        </p>
        <p>
          L’ensemble est affecté à une variable, ici la variable nommée
          <strong>filtre</strong>.
        </p>
        <ul>
          <li>
            Ligne 2 : on va évaluer la chaîne passée en argument
            <strong>"javascript"</strong>, avec le <strong>filtre</strong> en
            utilisant la <code>fonction</code> nommée <code>test()</code>, une
            méthode de l’objet RegExp de Javascript.
          </li>
        </ul>
        <p>
          Cette <strong>méthode renvoie</strong> un <strong>booléen</strong>,
          ici resultat vaut TRUE puisque la condition évaluée par le filtre est
          correcte.
        </p>
        <h2 id="17">Ressources Complémentaires</h2>
        <p>
          Le cours d'Openclassrooms sur les expressions régulières version PHP
          mais adaptable au javascript :
        </p>
        <ul>
          <li>
            <a
              href="https://openclassrooms.com/fr/courses/918836-concevez-votre-site-web-avec-php-et-mysql/916990-les-expressions-regulieres-partie-1-2"
              >OpenclassRooms</a
            >
          </li>
        </ul>
        <p>
          Un excellent outil en ligne pour construire et tester vos regex (
          Pensez à cliquer sur ECMAScript(JavaScript)) :
        </p>
        <ul>
          <li><a href="https://regex101.com/">REGEX 101</a></li>
        </ul>
        <p>
          Un exercice complet sur la validation de formulaires HTML en
          JavaScript par le créateur de contenu Pierre Giraud :
        </p>
        <ul>
          <li>
            <a
              href="https://www.pierre-giraud.com/javascript-apprendre-coder-cours/validation-formulaire/"
              >Le TD de Pierre Giraud sur la validation de formulaire</a
            >
          </li>
        </ul>
        <h2 id="24">Ecriture des règles</h2>
        <p>
          Deux types de caractères peuvent être utilisés dans les expressions
          régulières :
        </p>
        <p>
          les méta caractères <strong>. \ ? * + { } ( ) [ ] </strong> et les
          caractères normaux tout autre caractère, y compris les symboles
          précédents qui devront être alors représentés par des séquences
          d'échappement.
        </p>
        <h3 id="27">Les chaînes alphabétiques</h3>
        <p>
          <strong>[A-Za-z]</strong> permet de vérifier qu'un caractère fait
          partie des lettres <strong>"A" à "Z"</strong> et
          <strong>"a" à "z"</strong> (en dehors de tout caractère accentué).
        </p>
        <p>Les slashes / délimitent l'expression régulière.</p>
        <p>Mais on peut aussi bien mettre des guillemets :</p>
        <p><strong>/[A-Za-z]/</strong> ou <strong>"[A-Za-z]"</strong></p>
        <p>
          Pour indiquer que nous ne voulons QUE des caractères alphabétiques, il
          faut écrire :<strong>/^[A-Za-z]+$/</strong>
        </p>
        <p>
          Les 2 caractères « <strong>^</strong> » et « <strong>$</strong> »
          indiquent qu'il faut établir le contrôle du
          <strong>début à la fin de la chaîne</strong>.
        </p>
        <p>
          Le caractère « <strong>+</strong> » <strong>indique</strong> que le
          caractère alphabétique doit être
          <strong>présent au moins une fois</strong>.
        </p>
        <h3 id="35">Les chaînes numériques</h3>
        <p>
          <strong><code>/^[0-9]*$/</code></strong>
        </p>
        <p>L'expression [0-9] indique qu'on n'attend que des chiffres.</p>
        <p>On peut aussi utiliser « \d » à la place de [0-9].</p>
        <p>
          L'astérisque «<strong>*</strong>» signifie que le caractère peut être
          absent ou présent plusieurs fois (alors que « <strong>+</strong> »
          implique que le caractère soit présent au moins une fois).
        </p>
        <p>
          Donc si la chaîne est vide, elle sera considérée comme correcte, selon
          l'expression régulière.
        </p>
        <h3 id="41">Les dates</h3>
        <ul>
          <li>
            <p><strong>/^[0-9]+\/[0-9]+\/[0-9]+$/</strong></p>
            <p>
              Il s'agit seulement d'une date au format numérique, dans le style
              "14/7/2003". Dans l'expression régulière, on a 3 parties :
            </p>
            <p>
              le jour, le mois et l'année, qui sont des chiffres répétés
              plusieurs fois.
            </p>
            <p>
              Ils sont séparés par le signe « \/ » : on ne peut pas mettre
              simplement « / », parce que ce signe indique l'encadrement de
              l'expression régulière, donc il faut « échapper » le slash par un
              antislash (« \ »).
            </p>
          </li>
        </ul>
        <pre><code class="language-js hljs language-javascript">/^[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]?\/[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]?\/[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]([<span class="hljs-number">0</span>-<span class="hljs-number">9</span>][<span class="hljs-number">0</span>-<span class="hljs-number">9</span>])?$/  </code></pre>
        <p>
          Avec cette expression régulière on est obligé d'écrire le jour et le
          mois avec un ou 2 chiffres, et on doit écrire l'année sur 2 ou 4
          chiffres.
        </p>
        <p>C'est-à-dire : « 14/7/03 » ou « 14/7/2003 » ou « 14/07/2003 »</p>
        <p>On a introduit quelques nouveautés :</p>
        <ul>
          <li>
            <p>
              le ? indique que le caractère précédent peut être présent 0 fois
              ou 1 fois, donc [0-9][0-9]? signifie qu'on peut écrire un ou 2
              chiffres;
            </p>
          </li>
          <li>
            <p>
              les parenthèses permettent d'affecter le quantificateur (+, *, ?)
              à la série de caractères entre ces parenthèses : ([0-9][0-9])?
              signifie que ces 2 caractères peuvent être présents 0 fois ou 1
              fois.
            </p>
          </li>
        </ul>
        <p>
          Si l'on souhaite d'autre séparateur que le / pour la date, il faudra
          utiliser « <strong>(\/|-|.)</strong> » qui autorise soit le slash,
          soit le tiret, soit le point par exemple
        </p>
        <h3 id="49">Les adresses mail</h3>
        <p>
          Une adresse e-mail, par exemple <code>nom.prenom@site.fr</code> est
          constituée de 3 parties :
        </p>
        <p><strong>L'utilisateur</strong> (ici : <code>nom.prenom</code>) :</p>
        <p>
          est donc contrôlé par la séquence [_a-z0-9-]+(.[_a-z0-9-]+)<em>
            où [_a-z0-9-] représente les caractères alphanumériques, plus le
            caractère de soulignement, plus le tiret. La 2ème partie
            (.[_a-z0-9-]+)</em
          >
          permet d'ajouter des mots séparés par un point.
        </p>
        <p><strong>Le nom de domaine</strong> (ici : <code>site</code>) :</p>
        <p>
          Il suit l'arobase et ne peut contenir que des caractères
          alphanumériques, le caractère de souligne-ment, et le tiret :
          <strong>[a-z0-9-]+</strong>
        </p>
        <p>
          <strong>L’extension TLD</strong> (top level domain) (ici :
          <code>fr</code>) :
        </p>
        <p>
          Il est constitué seulement d'un point suivi de caractères
          alphanumériques, éventuellement répété plusieurs fois : « (.[a-z0-9]+)
          »
        </p>
        <p>Voici un exemple :</p>
        <ul>
          <li>
            <strong>^[a-z0-9.<em>-]+@[a-z0-9.</em>-]{2,}.[a-z]{2,4}$</strong>
          </li>
        </ul>
        <h3 id="59">Les numéros de téléphones</h3>
        <p>Numero de telephone de type 0111111111 :</p>
        <ul>
          <li><strong>^0[1-9]{9}$</strong></li>
        </ul>
        <p>
          Numero de telephone de type 0111111111 ou 01.11.11.11.11 ou 01 00 00
          00 00 ou 01-11-11-11-11 :
        </p>
        <ul>
          <li><strong>^0[1-9]([-. ]?[0-9]{2}){4}$</strong></li>
        </ul>
        <p>la même chose que</p>
        <ul>
          <li><strong>^0[1-9]([-. ]?\d{2}){4}$</strong></li>
        </ul>
        <h3 id="66">Autres cas</h3>
        <table>
          <thead>
            <tr>
              <th>Type</th>
              <th>Règle à vérifier</th>
              <th>Regex à appliquer</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Chaîne alphanumérique</td>
              <td>
                On peut aussi utiliser le caractère « \w », qui autorise les
                caractères alphanumériques ou le caractère de soulignement (_)
              </td>
              <td>/^[0-9A-Za-z]+$/</td>
            </tr>
            <tr>
              <td>Code couleur</td>
              <td>
                Un code couleur est constitué d'un « # », suivi d'un nombre
                hexadécimal, qui ne peut contenir que des chiffres ou des
                lettres de A à F.
              </td>
              <td>/^#[0-9A-F]+$/</td>
            </tr>
          </tbody>
        </table>
        <h3 id="68">Caractères spéciaux</h3>
        <p>
          Voici les principaux caractères spéciaux que vous pourrez utiliser
          dans vos expressions régulières.
        </p>
        <table>
          <thead>
            <tr>
              <th>Caractères spéciaux</th>
              <th>Signification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>\</td>
              <td>
                Si le caractère suivant est n'est pas un caractère spécial, cela
                signifie que ce caractère doit être considéré comme un caractère
                spécial.<br />Exemple :<br />\d signifie un chiffre<br />Si le
                caractère suivant est un caractère spécial, cela signifie qu'il
                faut prendre ce caractère de façon littérale.<br />Exemple \*
                cherche la présence d'un astérisque *
              </td>
            </tr>
            <tr>
              <td>^</td>
              <td>
                indique l'emplacement où doit commencer la chaîne de caractère à
                contrôler
              </td>
            </tr>
            <tr>
              <td>$</td>
              <td>
                indique l'emplacement où doit finir la chaîne de caractère à
                contrôler
              </td>
            </tr>
            <tr>
              <td>*</td>
              <td>
                indique que le caractère précédent doit être présent 0 fois ou
                plusieurs fois (soit absent soit présent ou répété)
              </td>
            </tr>
            <tr>
              <td>+</td>
              <td>
                indique que le caractère précédent doit être présent 1 fois ou
                plusieurs fois (donc au moins une fois)
              </td>
            </tr>
            <tr>
              <td>?</td>
              <td>
                indique que le caractère précédent doit être présent 0 ou 1 fois
                (soit absent soit présent mais pas répété)
              </td>
            </tr>
            <tr>
              <td>(x)</td>
              <td>
                le caractère doit correspondre à x et permet de mettre ce
                caractère en mémoire (sert pour la fonction "exec" qui découpe
                la chaîne testée dans un tableau)
              </td>
            </tr>
            <tr>
              <td>|</td>
              <td>
                ex : x|y, le caractère doit correspondre à x OU à y ("|" est le
                caractère CTL-ALT 6 ou AltGr 6 sur PC)
              </td>
            </tr>
            <tr>
              <td>{n}</td>
              <td>
                si n est un nombre, le caractère précédent doit être présent n
                fois
              </td>
            </tr>
            <tr>
              <td>{n, p}</td>
              <td>
                si n et p sont des nombres, le caractère précédent doit être
                présent au minimum n fois et au maximum p fois
              </td>
            </tr>
            <tr>
              <td>[abc]</td>
              <td>
                le caractère doit correspondre aux caractères entre crochets
                ("a", "b" ou "c")
              </td>
            </tr>
            <tr>
              <td>[^abc]</td>
              <td>
                le caractère ne doit pas correspondre aux caractères entre
                crochets ("a", "b" ou "c")
              </td>
            </tr>
            <tr>
              <td>\s</td>
              <td>
                le caractère doit correspondre à un espace, un retour chariot,
                ou un caractère de tabulation
              </td>
            </tr>
            <tr>
              <td>\S</td>
              <td>correspond à tous les caractères sauf l'espace</td>
            </tr>
            <tr>
              <td>\d</td>
              <td>correspond à [0-9], c'est-à-dire à un chiffre</td>
            </tr>
            <tr>
              <td>\D</td>
              <td>tout caractère sauf un chiffre</td>
            </tr>
            <tr>
              <td>\w</td>
              <td>
                correspond aux caractères alphanumériques + le "_" (équivalent à
                [A-Za-z0-9_])
              </td>
            </tr>
            <tr>
              <td>\W</td>
              <td>
                correspond à tous les caractères sauf les caractères
                alphanumériques et le "_" (équivalent à [^A-Za-z0-9_])
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="71">Fonctions</h3>
        <table>
          <thead>
            <tr>
              <th>Fonction</th>
              <th>Objet et exemples</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>test</td>
              <td>
                Retourne vrai si la chaîne respecte l’expression régulière, faux
                sinon.
              </td>
            </tr>
            <tr>
              <td>exec</td>
              <td>
                applique l’expression régulière à la chaîne et renvoie le
                résultat
              </td>
            </tr>
            <tr>
              <td>match</td>
              <td>
                applique l’expression régulière à la chaîne et renvoie le(s)
                résultat(s)
              </td>
            </tr>
            <tr>
              <td>replace</td>
              <td>
                remplace le(s) sous-chaîne(s) vérifiant l’expression régulière
                par la 2ème chaîne passée en argument et renvoie le résultat
              </td>
            </tr>
            <tr>
              <td>search</td>
              <td>
                renvoie la position de la première sous-chaîne vérifiant
                l’expression régulière
              </td>
            </tr>
            <tr>
              <td>split</td>
              <td>découpe une chaîne selon l’expression régulière</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <script>
      hljs.highlightAll();
    </script>
    <script>
      document.title = "" + document.querySelector("h1").textContent;
    </script>
  </body>
</html>
